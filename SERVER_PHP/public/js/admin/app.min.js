var lazyloadScripts=[],lazyloadStylesheet=[];function loadJS(e,t){if(lazyloadScripts.indexOf(e)>-1)return t();lazyloadScripts.push(e);var n=document.getElementsByTagName("script")[0],o=document.createElement("script");return o.src=e,o.async=!0,console.log("loadjs",e),n.parentNode.insertBefore(o,n),t&&"function"==typeof t&&(o.onload=t),o}function loadStylesheet(e,t){if(console.log(e,"href"),lazyloadStylesheet.indexOf(e)>-1)return!0;lazyloadStylesheet.push(e);var n=document.createElement("link");return n.href=e,n.rel=t,document.body.appendChild(n),n.onload=function(){console.log("success",e)},n.onerror=function(){console.log("error")},n}function link_sidebar_dropdown(){var e=$("#sidebar");e.hasClass("mini")||$("#sidebar .block_navigate").click(function(){var e=$(this),t=e.find(".dropdown__item"),n=!0;t.is(":hidden")&&(n=!1),t.slideToggle("fast",function(){n?e.removeClass("active"):e.addClass("active")})}),$("#sidebar .block_navigate").on("mouseover",function(){var e=$(this),t=$(".dropdown__item",e),n=e.position();t.css({top:n.top,left:n.left+Math.round(e.outerWidth())})}).hover(function(){e.hasClass("mini")&&(e.addClass("z-index-hight"),$(this).addClass("active-hover"))},function(){e.hasClass("mini")&&(e.removeClass("z-index-hight"),$(this).removeClass("active-hover"))})}function toggle_sidebar(){var e=$("#sidebar"),t=$("#js_right_content"),n=e.find(".js_toggle_navigate__icon"),o=t.find(".js_icon_fa_toggle"),a=!1;n.hasClass("hero-chevron-double-left")&&(a=!0),a?(n.removeClass("hero-chevron-double-left").addClass("hero-chevron-double-right"),e.addClass("mini"),t.addClass("sidebar-mini"),o.removeClass("fa-bars").addClass("fa-times-square")):(n.removeClass("hero-chevron-double-right").addClass("hero-chevron-double-left"),e.removeClass("mini"),t.removeClass("sidebar-mini"),o.addClass("fa-bars").removeClass("fa-times-square"))}function showErrorSystem(e){alert(" có lỗi "),console.log(e)}function showImage__InputCKFinder(e,t){var n=$(t).closest(".wrapper__selectImageWithCKFinder"),o=n.find(".output-image-finder"),a=n.hasClass("type-select-ckfinder__inline");o&&o.remove();var l=n.find("input.img__outputCKFinder");l&&(l.val(e),l.valid());var s=document.createElement("img");s.className="output-image-finder",s.src=e,s.onerror=function(){this.src="/images/failed.jpg"},a?n.find("input.img__outputCKFinder").before(s):n.find("input.img__outputCKFinder").parent().append(s)}function selectImageWithCKFinder(e,t){CKFinder.popup({chooseFiles:!0,width:800,height:600,onInit:function(n){n.on("files:choose",function(n){var o=n.data.files.first().getUrl();console.log(o),showImage__InputCKFinder(o,e,t)}),n.on("file:choose:resizedImage",function(n){showImage__InputCKFinder(n.data.resizedUrl,e,t)})}})}function createSlug(e){return e=e.toLowerCase(),wanakana&&(e=wanakana.toRomaji(e)),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a")).replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e")).replace(/i|í|ì|ỉ|ĩ|ị/gi,"i")).replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o")).replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u")).replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y")).replace(/đ/gi,"d")).replace(/[\u00C0-\u00C5]/gi,"a")).replace(/[\u00C8-\u00CB]/gi,"e")).replace(/[\u00CC-\u00CF]/gi,"i")).replace(/[\u00D2-\u00D6]/gi,"o")).replace(/[\u00D9-\u00DC]/gi,"u")).replace(/[\u00D1]/gi,"n")).trim().replace(/ /g,"-")).replace(/[\-]{2}/g,"")}function isExistSlug(e){var t=createSlug(e);if(!t)return!1;if($("input[name=slug]").val(t),$("#result-slug").remove(),$("#show-url").attr("href","/"+t),$("button[type=submit]").attr("disabled",!0),$("input[name=_slug_old]")){var n=$("input[name=_slug_old]").val();if(n==t)return showResultSlugExisted(n!=t),!0}fetch(ACTION_CHECK_SLUG+"/"+t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>showResultSlugExisted(!!e.ok)).catch(e=>{alert("có lỗi")})}function showResultSlugExisted(e){var t="slug đã tồn tại",n="text-color-danger";e||(t="slug chưa tồn tại",$("input[name=_slug_old]")&&$("input[name=_slug_old]").val()==$("input[name=slug]").val()&&(t="slug chưa thay đổi"),n="text-color-success-color-dark");var o=document.getElementById("result-slug");o&&o.remove();var a=document.createElement("p");a.id="result-slug",a.className=n,a.textContent=t,$("input[name=slug]").closest(".js-parent__create-slug").append(a),$("input[name=slug]").valid(),$("button[type=submit]").attr("disabled",e)}function toggleEditSlugLink(e){$(e.target);$("input[name=slug]").attr("readonly",function(e,t){return!t});var t=document.getElementById("js-toggle-icon-key");t&&t.classList.toggle("d-none");var n=document.getElementById("js-toggle-icon-edit");return n&&n.classList.toggle("d-none"),!1}function runSelect2Single(e){e.select2({language:{noResults:function(){return"không có kết quả trùng khớp"}}})}function runSelect2Multi(e){e.select2({language:{noResults:function(){return"không có kết quả trùng khớp"}}})}function removeBlockParent(e){$(e).closest(".js-group-option").remove(),$(".js-group-option").length||$("#sortable .js__remove-final").remove()}function showAllImagesCkfinderOnload(e){e.each(function(e){var t=$(this).val();t&&showImage__InputCKFinder(t,this)})}function listenChangeTypeOption(e){var t=$(e).closest(".js-group-option"),n=t.find('input[name="value_text[]"]'),o=t.find('textarea[name="value_html[]"]'),a=t.find(".cke");1==e.value?(n.removeClass("d-none"),o.addClass("d-none"),a.addClass("d-none")):(n.addClass("d-none"),o.removeClass("d-none"),a.length?a.removeClass("d-none"):CKEDITOR.replace(o.attr("id")))}function addMoreBlock(e){var t=document.getElementsByClassName("js-group-option"),n=null;if(t.length&&(n=t[0]),n){$(n).find("select").select2("destroy");var o=$(n).find(".js-clone-value-option"),a=o.find("input").clone(),l=o.find("textarea").clone(),s=$(n).find("select").clone();a.val(""),a.removeClass("d-none"),l.attr("id","ckeditor-"+t.length),l.attr("style",""),l.addClass("d-none"),s.attr("id","select2-"+t.length),s.val("1");var i=$(n).clone();i.find(".output-image-finder").remove(),runSelect2Single($(n).find("select")),i.find("input, textarea").val(""),i.find(".js-clone-value-option").html(""),i.find(".js-clone-value-option").append(a),i.find(".js-clone-value-option").append(l),i.find(".js-clone-select-option").html(""),i.find(".js-clone-select-option").append(s),runSelect2Single(i.find("select")),$(t).last().after(i)}}function drawMapRequest(){var e=new google.maps.StyledMapType([{stylers:[{saturation:0}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:0},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}],{name:"Google Map"});"undefined"!=typeof MAP_LAT&&"undefined"!=typeof MAP_LONG||(MAP_LAT=document.getElementById("map-request").getAttribute("data-lat"),MAP_LONG=document.getElementById("map-request").getAttribute("data-long"));var t=new google.maps.LatLng(MAP_LAT,MAP_LONG),n={zoom:17,scrollwheel:!1,center:t,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},o=new google.maps.Marker({position:t,map:a,icon:"/images/map-icon.png"}),a=new google.maps.Map(document.getElementById("map-request"),n);a.mapTypes.set("map_style",e),a.setMapTypeId("map_style"),o.setMap(a);var l='<div class="address_detail_map"><h4 class="main_color"> vị trí request</h4></div>';l=l.split("\n").join("<br />");var s=new google.maps.InfoWindow({content:l});o.addListener("click",function(){s.open(a,o)}),s.open(a,o)}function createJsonHowto(e){if(!document.getElementById(e)||"undefined"==typeof HOW_TO_DATA)return!1;JSONEditor.defaults.theme="foundation5",JSONEditor.defaults.iconlib="fontawesome4";var t=new JSONEditor(document.getElementById("editor_holder"),{ajax:!0,schema:{$ref:"/json/howto.json",format:"grid"},startval:HOW_TO_DATA});document.getElementById("js__save-json-textarea").addEventListener("click",function(){document.getElementById("js__json-how-to").value=JSON.stringify(t.getValue(),null,2)}),t.on("change",function(){var e=t.validate(),n=document.getElementById("valid_indicator");if(e.length){var o=e[0];n.className="label alert",n.textContent=`not valid - ${o.path} ${o.property} ${o.message}`,console.log(e)}else n.className="label success",n.textContent="valid";console.log(t.getValue()),document.getElementById("js__json-how-to").value=JSON.stringify(t.getValue(),null,2)})}$("textarea[id^='editor']").length&&$("textarea[id^='editor']").each(function(e){CKEDITOR.replace($(this).attr("id"),{format_tags:"p;h1;h2;h3;h4;h5;h6;pre;address;div"})}),$(document).ready(function(){createJsonHowto("js__json-how-to"),$("#js-show-google-map-request").click(function(){document.getElementById("map-request")&&"undefined"!=typeof GOOGLE_PLACES_API&&loadJS("https://maps.googleapis.com/maps/api/js?key="+GOOGLE_PLACES_API,drawMapRequest)}),link_sidebar_dropdown(),$(".js__select_option_type_format").each(function(){if(2==$(this).val()){var e=$(this).closest(".js-group-option").find(".js-clone-value-option");e.find("input").addClass("d-none"),e.find("textarea").removeClass("d-none"),CKEDITOR.replace(e.find("textarea").attr("id"))}});var e=$(".js__single-select"),t=$(".js__multi-select");e.length&&runSelect2Single(e),t.length&&runSelect2Multi(t);var n=$(".img__outputCKFinder");n.length&&showAllImagesCkfinderOnload(n)});